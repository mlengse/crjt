<style>
    .swal2-container {
        z-index: 999999;
    }
    .select2-container--default .select2-selection--multiple .select2-selection__choice {
        background-color: #417bff;
        border: 1px solid #fff;
        border-radius: 4px;
        cursor: default;
        float: left;
        margin-right: 2px;
        margin-top: 2px;
        padding: 0 5px;
    }
    .select2-container--default .select2-selection--multiple .select2-selection__choice__remove {
        color: #fff;
        cursor: pointer;
        display: inline-block;
        font-weight: bold;
        margin-right: 2px;
    }

    .switch {
        position: relative;
        display: inline-block;
        width: 60px;
        height: 34px;
    }

    .switch input {
        opacity: 0;
        width: 0;
        height: 0;
    }

    .slider {
        position: absolute;
        cursor: pointer;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: #ccc;
        -webkit-transition: .4s;
        transition: .4s;
    }

    .slider:before {
        position: absolute;
        content: "";
        height: 26px;
        width: 26px;
        left: 4px;
        bottom: 4px;
        background-color: white;
        -webkit-transition: .4s;
        transition: .4s;
    }

    input:checked + .slider {
        background-color: #2196F3;
    }

    input:focus + .slider {
        box-shadow: 0 0 1px #2196F3;
    }

    input:checked + .slider:before {
        -webkit-transform: translateX(26px);
        -ms-transform: translateX(26px);
        transform: translateX(26px);
    }

    /* Rounded sliders */
    .slider.round {
        border-radius: 34px;
    }

    .slider.round:before {
        border-radius: 50%;
    }
    .fancybox-content {
        padding: 0;
        border: 1px solid #E5E8F2;
        box-sizing: border-box;
        border-radius: 8px;
    }
    #select2-status_id-results {
        max-height: 100px;
    }
    #select2-purpose-rdt-results {
        max-height: 100px;
    }
</style>

<div class="content" style="width:95%">
    <div class="card">
        <form id="tambah" method="post" action="https://admin.corona.jatengprov.go.id/people" enctype='multipart/form-data'>
            <div class="card-header">
                <div class="row">
                    <div class="col-10">
                        <h4><i class="fa fa-plus-circle"></i> Form Input Kasus Berdasarkan NIK</h4>
                    </div>
                    <div class="col-2 text-right">

                    </div>
                </div>

            </div>
            <input type="hidden" name="_token" value="Egoh8yaLYW8bFpOFptmkrd1Skn4oeTGp4oHnmzEA">            <div class="card-body">
                <legend style="color: #2D9CDB;">Data Pribadi</legend>
                <div class="row">
                    <div class="col-md-3">
                        <div class="form-group">
                            <label for="nik">NIK <small class="text-danger">Wajib</small></label>
                            <div class="row">
                                <div class="col-md-10">
                                    <input type="number" class="form-control" name="nik" id="nik" placeholder="Masukan NIK" minlength="16" min="0" required>
                                </div>
                                <div class="col-md-2">
                                    <button type="button" class="btn btn-primary" id="cek-nik" style="height: 37px" data-toggle="tooltip" data-placement="top" title="Cek Ke Capil dan NAR, untuk mengisi field secara automatis"><i class="fa fa-search"></i></button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label for="name">Nama <small class="text-danger">Wajib,Tanpa (Gelar/Ny/Tn)</small></label>
                            <input type="text" class="form-control" name="name" id="name" placeholder="Masukan nama" required>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label for="age">TGL Lahir <small class="text-danger">Wajib</small></label>
                            <input type="text" class="form-control" name="birth_date" id="birth_date" style="background-color: white;"
                                   data-language="id"
                                   data-date-format="dd-mm-yyyy"
                                   data-position="bottom left"
                                   autocomplete="off"
                                   placeholder="dd-mm-yyyy"
                            >
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label for="phone_number">No Telp / HP <small class="text-danger">Wajib</small></label>
                            <input type="text" class="form-control phone_number" name="phone_number" id="phone_number" placeholder="____-____-____-___" maxlength="15"  required>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label for="sex">Jenis Kelamin <small class="text-danger">Wajib</small></label>
                            <div class="form-group">
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" name="sex" id="sexL" value="L" checked>
                                    <label class="form-check-label" for="sexL">Laki-Laki</label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" name="sex" id="sexP" value="P">
                                    <label class="form-check-label" for="sexP">Perempuan</label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label for="blood_type">Golongan Darah <small>Opsional</small></label>
                            <select class="form-control select-2" id="blood_type" name="blood_type" style="width: 100%">
                                <option value="" selected>Pilih</option>
                                <option value="A">A</option>
                                <option value="B">B</option>
                                <option value="B">O</option>
                                <option value="AB">AB</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label for="job">Pekerjaan <small class="text-danger">Wajib</small></label>
                            <select class="form-control select-2" id="job" name="job" required>
                                                                    <option value="3">Tidak Tahu</option>
                                                                    <option value="4">Belum / Tidak Bekerja</option>
                                                                    <option value="5">Mengurus Rumah Tangga</option>
                                                                    <option value="6">Pelajar / Mahasiswa</option>
                                                                    <option value="7">Pensiunan</option>
                                                                    <option value="8">Pegawai Negeri Sipil</option>
                                                                    <option value="9">Tentara Nasional Indonesia</option>
                                                                    <option value="10">Kepolisisan RI</option>
                                                                    <option value="11">Perdagangan</option>
                                                                    <option value="12">Petani/ Pekebun</option>
                                                                    <option value="13">Peternak</option>
                                                                    <option value="14">Nelayan/ Perikanan</option>
                                                                    <option value="15">Industri</option>
                                                                    <option value="16">Konstruksi</option>
                                                                    <option value="17">Transportasi</option>
                                                                    <option value="18">Karyawan Swasta</option>
                                                                    <option value="19">Karyawan BUMN</option>
                                                                    <option value="20">Karyawan BUMD</option>
                                                                    <option value="21">Karyawan Honorer</option>
                                                                    <option value="22">Buruh Harian Lepas</option>
                                                                    <option value="23">Buruh Tani/ Perkebunan</option>
                                                                    <option value="24">Buruh Nelayan/ Perikanan</option>
                                                                    <option value="25">Buruh Peternakan</option>
                                                                    <option value="26">Pembantu Rumah Tangga</option>
                                                                    <option value="27">Tukang Cukur</option>
                                                                    <option value="28">Tukang Listrik</option>
                                                                    <option value="29">Tukang Batu</option>
                                                                    <option value="30">Tukang Kayu</option>
                                                                    <option value="31">Tukang Sol Sepatu</option>
                                                                    <option value="32">Tukang Las/ Pandai Besi</option>
                                                                    <option value="33">Tukang Jahit</option>
                                                                    <option value="34">Tukang Gigi</option>
                                                                    <option value="35">Penata Rias</option>
                                                                    <option value="36">Penata Busana</option>
                                                                    <option value="37">Penata Rambut</option>
                                                                    <option value="38">Mekanik</option>
                                                                    <option value="39">Seniman</option>
                                                                    <option value="40">Tabib</option>
                                                                    <option value="41">Paraji</option>
                                                                    <option value="42">Perancang Busana</option>
                                                                    <option value="43">Penterjemah</option>
                                                                    <option value="44">Imam Masjid</option>
                                                                    <option value="45">Pendeta</option>
                                                                    <option value="46">Pastor</option>
                                                                    <option value="47">Wartawan</option>
                                                                    <option value="48">Ustadz/ Mubaligh</option>
                                                                    <option value="49">Juru Masak</option>
                                                                    <option value="50">Promotor Acara</option>
                                                                    <option value="51">Anggota DPR-RI</option>
                                                                    <option value="52">Anggota DPD</option>
                                                                    <option value="53">Anggota BPK</option>
                                                                    <option value="54">Presiden</option>
                                                                    <option value="55">Wakil Presiden</option>
                                                                    <option value="56">Anggota Mahkamah Konstitusi</option>
                                                                    <option value="57">Anggota Kabinet/ Kementerian</option>
                                                                    <option value="58">Duta Besar</option>
                                                                    <option value="59">Gubernur</option>
                                                                    <option value="60">Wakil Gubernur</option>
                                                                    <option value="61">Bupati</option>
                                                                    <option value="62">Wakil Bupati</option>
                                                                    <option value="63">Walikota</option>
                                                                    <option value="64">Wakil Walikota</option>
                                                                    <option value="65">Anggota DPRD Provinsi</option>
                                                                    <option value="66">Anggota DPRD Kabupaten/ Kota</option>
                                                                    <option value="67">Dosen</option>
                                                                    <option value="68">Guru</option>
                                                                    <option value="69">Pilot</option>
                                                                    <option value="70">Pengacara</option>
                                                                    <option value="71">Notaris</option>
                                                                    <option value="72">Arsitek</option>
                                                                    <option value="73">Akuntan</option>
                                                                    <option value="74">Konsultan</option>
                                                                    <option value="75">Dokter</option>
                                                                    <option value="76">Bidan</option>
                                                                    <option value="77">Perawat</option>
                                                                    <option value="78">Apoteker</option>
                                                                    <option value="79">Psikiater/ Psikolog</option>
                                                                    <option value="80">Penyiar Televisi</option>
                                                                    <option value="81">Penyiar Radio</option>
                                                                    <option value="82">Pelaut</option>
                                                                    <option value="83">Peneliti</option>
                                                                    <option value="84">Sopir</option>
                                                                    <option value="85">Pialang</option>
                                                                    <option value="86">Paranormal</option>
                                                                    <option value="87">Pedagang</option>
                                                                    <option value="88">Perangkat Desa</option>
                                                                    <option value="89">Kepala Desa</option>
                                                                    <option value="90">Biarawati</option>
                                                                    <option value="91">Wiraswasta</option>
                                                                    <option value="93">Dokter gigi</option>
                                                                    <option value="94">Dokter spesialis</option>
                                                                    <option value="95">Dokter gigi spesialis </option>
                                                                    <option value="96">Psikologis klinis </option>
                                                                    <option value="97">Tenaga teknis kefarmasian </option>
                                                                    <option value="98">Tenaga kesehatan masyarakat </option>
                                                                    <option value="99">Tenaga kesehatan lingkungan </option>
                                                                    <option value="100">Tenaga gizi </option>
                                                                    <option value="101">Fisioterapis </option>
                                                                    <option value="102">Okupasi terapis </option>
                                                                    <option value="103">Terapis wicara </option>
                                                                    <option value="104">Akupuntur </option>
                                                                    <option value="105">Perekam medis dan informasi kesehatan </option>
                                                                    <option value="106">Teknik kardiovaskuler </option>
                                                                    <option value="107">Teknisi pelayanan darah </option>
                                                                    <option value="108">Refraksionis optisien </option>
                                                                    <option value="109">Teknisi gigi </option>
                                                                    <option value="110">Penata anestesi </option>
                                                                    <option value="111">Terapis gigi dan mulut </option>
                                                                    <option value="112">Audiologis </option>
                                                                    <option value="113">Radiografer </option>
                                                                    <option value="114">Elektromedis </option>
                                                                    <option value="115">Ahli teknologi laboratorium medik </option>
                                                                    <option value="116">Fisikawan medik </option>
                                                                    <option value="117">Radioterapis</option>
                                                                    <option value="118">Ortotik prostetik </option>
                                                            </select>

                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label for="job_place">Tempat Kerja <small class="text-danger">Wajib</small></label>
                            <select class="form-control" id="job_place" name="job_place" required>
                                <option value="TIDAK TAHU" selected>TIDAK TAHU</option>
                            </select>
                        </div>
                    </div>
                </div>
                <legend style="color: #2D9CDB;">Alamat Domisili</legend>
                <div class="row">
                    <div class="col-md-3" style="display:block;">
                        <div class="row">
                            <label for="district_id" class="col-md-12">Sama Dengan KTP ?<span class="badge"></span></label>
                        </div>
                        <div class="row">
                            <label class="col-md-4 text-right" style="padding-top:5px;">Tidak<span class="badge"></span></label>
                            <label class="switch">
                                <input type="checkbox" id="is_same_ktp">
                                <span class="slider round"></span>
                            </label>
                            <label class="col-md-4" style="padding-top:5px;">Iya<span class="badge"></span></label>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label for="province_id">Provinsi<span class="badge text-danger">Wajib (Domisili)</span></label>
                            <select class="form-control select-2" id="province_id" name="province_id" style="width: 100%" required>
                                <option value="null" disabled selected>Pilih Provinsi</option>
                                                                                                            <option value="32676" selected>JAWA TENGAH</option>
                                                                                                                                                <option value="929285">ACEH</option>
                                                                                                                                                <option value="929286">SUMATERA UTARA</option>
                                                                                                                                                <option value="929287">SUMATERA BARAT</option>
                                                                                                                                                <option value="929288">RIAU</option>
                                                                                                                                                <option value="929289">JAMBI</option>
                                                                                                                                                <option value="929290">SUMATERA SELATAN</option>
                                                                                                                                                <option value="929291">BENGKULU</option>
                                                                                                                                                <option value="929292">LAMPUNG</option>
                                                                                                                                                <option value="929293">KEPULAUAN BANGKA BELITUNG</option>
                                                                                                                                                <option value="929294">KEPULAUAN RIAU</option>
                                                                                                                                                <option value="929295">DKI JAKARTA</option>
                                                                                                                                                <option value="929296">JAWA BARAT</option>
                                                                                                                                                <option value="929297">DAERAH ISTIMEWA YOGYAKARTA</option>
                                                                                                                                                <option value="929298">JAWA TIMUR</option>
                                                                                                                                                <option value="929299">BANTEN</option>
                                                                                                                                                <option value="929300">BALI</option>
                                                                                                                                                <option value="929301">NUSA TENGGARA BARAT</option>
                                                                                                                                                <option value="929302">NUSA TENGGARA TIMUR</option>
                                                                                                                                                <option value="929303">KALIMANTAN BARAT</option>
                                                                                                                                                <option value="929304">KALIMANTAN TENGAH</option>
                                                                                                                                                <option value="929305">KALIMANTAN SELATAN</option>
                                                                                                                                                <option value="929306">KALIMANTAN TIMUR</option>
                                                                                                                                                <option value="929307">KALIMANTAN UTARA</option>
                                                                                                                                                <option value="929308">SULAWESI UTARA</option>
                                                                                                                                                <option value="929309">SULAWESI TENGAH</option>
                                                                                                                                                <option value="929310">SULAWESI SELATAN</option>
                                                                                                                                                <option value="929311">SULAWESI TENGGARA</option>
                                                                                                                                                <option value="929312">GORONTALO</option>
                                                                                                                                                <option value="929313">SULAWESI BARAT</option>
                                                                                                                                                <option value="929314">MALUKU</option>
                                                                                                                                                <option value="929315">MALUKU UTARA</option>
                                                                                                                                                <option value="929316">PAPUA</option>
                                                                                                                                                <option value="929317">PAPUA BARAT</option>
                                                                                                </select>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label for="district_id">Kab / Kota <span class="badge text-danger">Wajib (Domisili)</span></label>
                            <select class="form-control select-2" id="district_id" name="district_id" style="width: 100%" required>
                                <option value="null" disabled selected>Pilih Kabupaten / Kota</option>
                                                                    <option value="32677">CILACAP</option>
                                                                    <option value="32986">BANYUMAS</option>
                                                                    <option value="33345">PURBALINGGA</option>
                                                                    <option value="33603">BANJARNEGARA</option>
                                                                    <option value="33902">KEBUMEN</option>
                                                                    <option value="34389">PURWOREJO</option>
                                                                    <option value="34900">WONOSOBO</option>
                                                                    <option value="35181">MAGELANG</option>
                                                                    <option value="35575">BOYOLALI</option>
                                                                    <option value="35862">KLATEN</option>
                                                                    <option value="36290">SUKOHARJO</option>
                                                                    <option value="36470">WONOGIRI</option>
                                                                    <option value="36790">KARANGANYAR</option>
                                                                    <option value="36985">SRAGEN</option>
                                                                    <option value="37214">GROBOGAN</option>
                                                                    <option value="37514">BLORA</option>
                                                                    <option value="37826">REMBANG</option>
                                                                    <option value="38136">PATI</option>
                                                                    <option value="38564">KUDUS</option>
                                                                    <option value="38706">JEPARA</option>
                                                                    <option value="38917">DEMAK</option>
                                                                    <option value="39181">SEMARANG</option>
                                                                    <option value="39436">TEMANGGUNG</option>
                                                                    <option value="39746">KENDAL</option>
                                                                    <option value="40053">BATANG</option>
                                                                    <option value="40317">PEKALONGAN</option>
                                                                    <option value="40622">PEMALANG</option>
                                                                    <option value="40859">TEGAL</option>
                                                                    <option value="41165">BREBES</option>
                                                                    <option value="41480">KOTA MAGELANG</option>
                                                                    <option value="41501">KOTA SURAKARTA</option>
                                                                    <option value="41558">KOTA SALATIGA</option>
                                                                    <option value="41585">KOTA SEMARANG</option>
                                                                    <option value="41779">KOTA PEKALONGAN</option>
                                                                    <option value="41831">KOTA TEGAL</option>
                                                            </select>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label for="sub_district_id">Kecamatan <span class="badge text-danger">Wajib (Domisili)</span></label>
                            <select class="form-control select-2" id="sub_district_id" name="sub_district_id" style="width: 100%">
                                <option value="null" disabled>Pilih Kecamatan</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label for="village_id">Desa / Kel <span class="badge text-danger">Wajib (Domisili)</span></label>
                            <select class="form-control select-2" id="village_id" name="village_id" style="width: 100%">
                                <option value="null" disabled>Pilih Desa</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="rt-edit">RT <span class="badge text-danger">Wajib (Domisili)</span></label>
                                    <input type="number" class="form-control" name="rt" id="rt" placeholder="RT" required min="1" max="99">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="rw-edit">RW <span class="badge text-danger">Wajib (Domisili)</span></label>
                                    <input type="number" class="form-control" name="rw" id="rw" placeholder="RW" required min="1" max="99">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label for="address">Keterangan Alamat  <span class="badge text-danger">Wajib (Domisili)</span></label>
                            <input type="text" class="form-control" name="address" id="address" placeholder="Misal: nama jalan, RT/RW atau gang" required>
                        </div>
                    </div>
                </div>
                <legend style="color: #2D9CDB;">Alamat KTP</legend>
                <div class="row">
                    <div class="col-md-3">
                        <div class="form-group">
                            <label for="district_id">Provinsi<span class="badge">(KTP)</span></label>
                            <select class="form-control select-2" id="ktp_province_id" name="ktp_province_id" style="width: 100%" required>
                                <option value="null" disabled selected>Pilih Provinsi</option>
                                                                                                            <option value="32676" selected>JAWA TENGAH</option>
                                                                                                                                                <option value="929285">ACEH</option>
                                                                                                                                                <option value="929286">SUMATERA UTARA</option>
                                                                                                                                                <option value="929287">SUMATERA BARAT</option>
                                                                                                                                                <option value="929288">RIAU</option>
                                                                                                                                                <option value="929289">JAMBI</option>
                                                                                                                                                <option value="929290">SUMATERA SELATAN</option>
                                                                                                                                                <option value="929291">BENGKULU</option>
                                                                                                                                                <option value="929292">LAMPUNG</option>
                                                                                                                                                <option value="929293">KEPULAUAN BANGKA BELITUNG</option>
                                                                                                                                                <option value="929294">KEPULAUAN RIAU</option>
                                                                                                                                                <option value="929295">DKI JAKARTA</option>
                                                                                                                                                <option value="929296">JAWA BARAT</option>
                                                                                                                                                <option value="929297">DAERAH ISTIMEWA YOGYAKARTA</option>
                                                                                                                                                <option value="929298">JAWA TIMUR</option>
                                                                                                                                                <option value="929299">BANTEN</option>
                                                                                                                                                <option value="929300">BALI</option>
                                                                                                                                                <option value="929301">NUSA TENGGARA BARAT</option>
                                                                                                                                                <option value="929302">NUSA TENGGARA TIMUR</option>
                                                                                                                                                <option value="929303">KALIMANTAN BARAT</option>
                                                                                                                                                <option value="929304">KALIMANTAN TENGAH</option>
                                                                                                                                                <option value="929305">KALIMANTAN SELATAN</option>
                                                                                                                                                <option value="929306">KALIMANTAN TIMUR</option>
                                                                                                                                                <option value="929307">KALIMANTAN UTARA</option>
                                                                                                                                                <option value="929308">SULAWESI UTARA</option>
                                                                                                                                                <option value="929309">SULAWESI TENGAH</option>
                                                                                                                                                <option value="929310">SULAWESI SELATAN</option>
                                                                                                                                                <option value="929311">SULAWESI TENGGARA</option>
                                                                                                                                                <option value="929312">GORONTALO</option>
                                                                                                                                                <option value="929313">SULAWESI BARAT</option>
                                                                                                                                                <option value="929314">MALUKU</option>
                                                                                                                                                <option value="929315">MALUKU UTARA</option>
                                                                                                                                                <option value="929316">PAPUA</option>
                                                                                                                                                <option value="929317">PAPUA BARAT</option>
                                                                                                </select>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label for="district_id">Kab / Kota <span class="badge">(KTP)</span></label>
                            <select class="form-control select-2" id="ktp_district_id" name="ktp_district_id" style="width: 100%" required>
                                <option value="null" disabled selected>Pilih Kabupaten / Kota</option>
                                                                    <option value="32677">CILACAP</option>
                                                                    <option value="32986">BANYUMAS</option>
                                                                    <option value="33345">PURBALINGGA</option>
                                                                    <option value="33603">BANJARNEGARA</option>
                                                                    <option value="33902">KEBUMEN</option>
                                                                    <option value="34389">PURWOREJO</option>
                                                                    <option value="34900">WONOSOBO</option>
                                                                    <option value="35181">MAGELANG</option>
                                                                    <option value="35575">BOYOLALI</option>
                                                                    <option value="35862">KLATEN</option>
                                                                    <option value="36290">SUKOHARJO</option>
                                                                    <option value="36470">WONOGIRI</option>
                                                                    <option value="36790">KARANGANYAR</option>
                                                                    <option value="36985">SRAGEN</option>
                                                                    <option value="37214">GROBOGAN</option>
                                                                    <option value="37514">BLORA</option>
                                                                    <option value="37826">REMBANG</option>
                                                                    <option value="38136">PATI</option>
                                                                    <option value="38564">KUDUS</option>
                                                                    <option value="38706">JEPARA</option>
                                                                    <option value="38917">DEMAK</option>
                                                                    <option value="39181">SEMARANG</option>
                                                                    <option value="39436">TEMANGGUNG</option>
                                                                    <option value="39746">KENDAL</option>
                                                                    <option value="40053">BATANG</option>
                                                                    <option value="40317">PEKALONGAN</option>
                                                                    <option value="40622">PEMALANG</option>
                                                                    <option value="40859">TEGAL</option>
                                                                    <option value="41165">BREBES</option>
                                                                    <option value="41480">KOTA MAGELANG</option>
                                                                    <option value="41501">KOTA SURAKARTA</option>
                                                                    <option value="41558">KOTA SALATIGA</option>
                                                                    <option value="41585">KOTA SEMARANG</option>
                                                                    <option value="41779">KOTA PEKALONGAN</option>
                                                                    <option value="41831">KOTA TEGAL</option>
                                                            </select>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label for="sub_district_id">Kecamatan <span class="badge">(KTP)</span></label>
                            <select class="form-control select-2" id="ktp_sub_district_id" name="ktp_sub_district_id" style="width: 100%">
                                <option value="null" disabled>Pilih Kecamatan</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label for="village_id">Desa / Kel <span class="badge">(KTP)</span></label>
                            <select class="form-control select-2" id="ktp_village_id" name="ktp_village_id" style="width: 100%">
                                <option value="null" disabled>Pilih Desa</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="rt-edit">RT <small>(KTP)</small></label>
                                    <input type="number" class="form-control" name="ktp_rt" id="ktp_rt" placeholder="RT" required min="1" max="99">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="rw-edit">RW <small>(KTP)</small></label>
                                    <input type="number" class="form-control" name="ktp_rw" id="ktp_rw" placeholder="RW" required min="1" max="99">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label for="address">Keterangan Alamat  <span class="badge">(KTP)</span></label>
                            <input type="text" class="form-control" name="ktp_address" id="ktp_address" placeholder="Misal: nama jalan, RT/RW atau gang" required>
                        </div>
                    </div>
                </div>
                <legend style="color: #2D9CDB;">Tindakan Pada Pasien</legend>
                <p>Khusus pasien terkonfirmasi dengan jenis tes PCR Swab. Pilih status pasien sebelum terkonfirmasi, lalu lakukan mekanisme update status disertai hasil lab AR-TC19</p>
                <div class="row">
                    <div class="col-md-3">
                        <div class="form-group">
                            <label for="common_condition">Kondisi Umum <small class="text-danger">Wajib</small></label>
                            <input type="text" class="form-control" name="common_condition" id="common_condition" placeholder="Misal: lemas, pingsan. dsb" required maxlength="255">
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label for="treatment">Tindakan <small class="text-danger">Wajib</small></label>
                            <input type="text" class="form-control" name="treatment" id="treatment" placeholder="Misal: dirawat, isolasi. dsb" required maxlength="255">
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label for="tgl_lapor">TGL Lapor/Masuk RS <small class="text-danger">Wajib</small></label>
                            <input type="text" class="form-control tgl" name="tgl_lapor" id="tgl_lapor" style="background-color: white;"
                                   data-language="id"
                                   data-date-format="dd-mm-yyyy"
                                   data-position="top left"
                                   autocomplete="off"
                                   placeholder="dd-mm-yyyy"
                                   required
                                   readonly
                            >
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label for="treatment_place_id">Tempat tindakan <small class="text-danger">Wajib</small></label>
                            <select class="form-control select-2" style="width:100%;" id="treatment_place_id" name="treatment_place_id"  required >
                                                                                                            <option value="1149" selected>Puskesmas Jayengan</option>
                                                                                                </select>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label for="status_id">Status <small class="text-danger">Wajib</small></label>
                            <select class="form-control" style="width:100%;" id="status_id" name="status_id">
                                <option value="" selected disabled>--Pilih Status--</option>
                                                                    <option value="1">Terkonfirmasi Dirawat</option>
                                                                    <option value="2">Terkonfirmasi Isolasi Mandiri</option>
                                                                    <option value="5">Kontak Erat Isolasi</option>
                                                                    <option value="7">Terkonfirmasi Isolasi Terpusat</option>
                                                                    <option value="11">Suspek Dirawat</option>
                                                                    <option value="12">Suspek Isolasi</option>
                                                                    <option value="20">Screening</option>
                                                                    <option value="21">Pelaku Perjalanan</option>
                                                            </select>
                        </div>
                    </div>
                    <div class="col-md-6" id="case_travel_place" style="display: none;"></div>
                    <div class="col-md-3" id="case_saverity_level" style="display: none;">
                        <div class="form-group">
                            <label for="saverity_level">Saverity Level <small class="text-danger">Wajib</small></label>
                            <div class="row" style="margin-top: .15rem;">
                                <input type="text" class="form-control col-md-8" id="saverity_level_text" name="saverity_level_text" value="" readonly>
                                <input type="hidden" id="saverity_level" name="saverity_level" value="" readonly>
                                <button class="btn btn-primary col-md-4" type="button" id="btn-saverity-level"><i class="fa fa-mouse-pointer"></i> Pilih</button>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3" id="case_swab_type" style="display: none;"></div>
                </div>
                <div id="case_genose" style="display:none;"></div>
                <div id="case_swab_rdt" style="display:none;">
                    <legend style="color: #2D9CDB;">Data Tes RDT Antigen</legend>
                    <div class="row">
                        <div class="col-md-3">
                            <div class="form-group">
                                <label for="criteria">Kriteria Kab/Kota Faskes <small class="text-danger">Wajib</small></label>
                                <div class="row" style="margin-left:2px;margin-right: 2px;">
                                    <input type="text" class="form-control col-md-8" id="criteria_text_rdt" name="criteria_text_rdt" value="" readonly>
                                    <button class="btn btn-primary col-md-4" type="button" id="btn-criteria-rdt"><i class="fa fa-mouse-pointer"></i> Pilih</button>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label for="test_date_rdt" class=" col-form-label">TGL Test <small class="text-danger">Wajib</small></label>
                                <input type="text" class="form-control tgl" name="test_date_rdt" id="test_date_rdt" style="background-color: white;"
                                       data-language="id"
                                       data-date-format="dd-mm-yyyy"
                                       data-position="top left"
                                       autocomplete="off"
                                       placeholder="dd-mm-yyyy (Wajib)"
                                       readonly
                                >
                            </div>
                        </div>
                        <div class="col-md-3">
                            <label for="result" class="col-form-label">Hasil <small class="text-danger">Wajib</small></label>
                            <div class="form-group">
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" name="result_rdt" id="resultNegatif" value="NEGATIF">
                                    <label class="form-check-label text-success text-bold" for="resultNegatif">NEGATIF</label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" name="result_rdt" id="resultPositif" value="POSITIF" checked>
                                    <label class="form-check-label text-danger text-bold" for="POSITIF">POSITIF</label>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <label for="payment_rdt" class="col-form-label">Pembiayaan <small class="text-danger">Wajib</small></label>
                            <div class="form-group">
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" name="payment_rdt" id="paymentBerbayar" value="1" checked>
                                    <label class="form-check-label text-bold" for="paymentBerbayar">Berbayar</label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" name="payment_rdt" id="paymentTidakBerbayar" value="2">
                                    <label class="form-check-label text-bold" for="paymentTidakBerbayar">Tidak Berbayar</label>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label for="treatment" class="col-form-label">Kode Spesimen <small class="text-danger">Wajib</small> </label>
                                <input type="text" class="form-control" name="speciment_code_rdt" id="speciment_code_rdt" placeholder="AG.01.01">
                            </div>
                        </div>
                        <div class="col-md-3">
                            <label for="purpose-rdt">Tujuan Pemeriksaan <small class="text-danger">Wajib</small></label>
                            <select class="form-control" id="purpose-rdt" name="purpose_rdt" style="width: 100%">
                                <option value="" selected disabled>Pilih Tujuan</option>

                            </select>
                        </div>
                        <div class="col-md-3">
                            <label for="swab_lab_name" class="col-form-label">Pengambilan Spesimen Ke- </label>
                            <input type="number" min="1" max="30" class="form-control" name="swab_period_rdt" id="swab_period_rdt" placeholder="Spesimen RDT ke berapa" value="1">
                        </div>
                        <div class="col-md-3">
                            <label for="keterangan">Kesimpulan <small class="text-danger">Wajib</small></label>
                            <input type="text" class="form-control" id="keterangan_rdt" name="keterangan_rdt" readonly>
                        </div>
                    </div>
                </div>
            </div>
            <div class="card-footer" style="height: 100px;">
                <input type="hidden" id="criteria" name="criteria" value="" readonly>
                <input type="hidden" class="form-control" id="age_year" name="age_year" value="" readonly>
                <input type="hidden" class="form-control" id="age_month" name="age_month" value="" readonly>
                <input type="hidden" id="kd_pasien" name="kd_pasien" value="">
                <div class="row">
                    <div class="col-md-8"></div>
                    <div class="col-md-4">
                        <button type="submit" class="btn btn-success float-right btn-submit col-md-6"><i class="fa fa-save"></i> Simpan</button>
                        <button type="button" class="btn btn-primary float-right col-md-6" id="check_duplicate"><i class="fa fa-mark"></i> CEK DUPLIKAT</button>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>
<script>
    $('document').ready(function(){
        let session = 10;
        let district
        let subDistrict
        let village
        let ktpDistrict
        let ktpSubDistrict
        let ktpVillage
        let isCheckValid = false
        let isDuplicate = true
        let regexCalendar = "^(?:(?:31(-)(?:0?[13578]|1[02]))\\1|(?:(?:29|30)(-)(?:0?[1,3-9]|1[0-2])\\2))(?:(?:1[6-9]|[2-9]\\d)?\\d{2})$|^(?:29(-)(?:0?2)\\3(?:(?:(?:1[6-9]|[2-9]\\d)?(?:0[48]|[2468][048]|[13579][26])|(?:(?:16|[2468][048]|[3579][26])00))))$|^(?:0?[1-9]|1\\d|2[0-8])(-)(?:(?:0?[1-9])|(?:1[0-2]))\\4(?:(?:1[6-9]|[2-9]\\d)?\\d{2})$"
        // init
        $('.tgl').datepicker({
            todayButton: new Date(),
            autoClose:true,
            clearButton:true,
            minDate:new Date(2020, 0, 1),
            maxDate:new Date()
        })
        $('#birth_date').datepicker({
            todayButton: new Date(),
            autoClose:true,
            clearButton:true,
            minDate:new Date(1920, 0, 1),
            maxDate:new Date(),
            onSelect: function(dateText,date) {
                $(this).change();
                getAge(date)
            }
        })
        $('#birth_date').change(function(){
            let value = $(this).val()
            if (value.match(regexCalendar)) {
                let dateString  = value.match("^(\\d{2})-(\\d{2})-(\\d{4})$")
                let date = new Date( dateString[3], dateString[2]-1, dateString[1] );
                getAge(date)
            }
        })
        // input mask
        $(".phone_number").mask("9999-9999-9999-999");
        // init select2
        $('.select-2').select2();

        $('#is_same_ktp').change(function(){
            if($("#is_same_ktp").is(':checked')){
                $('#province_id').val($('#ktp_province_id').val()).trigger('change')
                district.then(()=>{
                    $('#district_id').val($('#ktp_district_id').val()).trigger('change')
                    subDistrict.then(()=>{
                        $('#sub_district_id').val($('#ktp_sub_district_id').val()).trigger('change')
                        village.then(()=>{
                            $('#village_id').val($('#ktp_village_id').val()).trigger('change')
                        })
                    })
                })
                $('#rt').val($('#ktp_rt').val())
                $('#rw').val($('#ktp_rw').val())
                $('#address').val($('#ktp_address').val())

                // disable input ktp
                $("#province_id").prop("readonly", true);
                $("#district_id").prop("readonly", true);
                $("#sub_district_id").prop("readonly", true);
                $("#village_id").prop("readonly", true);
                $("#rt").prop("readonly", true);
                $("#rw").prop("readonly", true);
                $("#address").prop("readonly", true);
            }else{
                // enable input ktp
                $("#province_id").prop("readonly", false);
                $("#district_id").prop("readonly", false);
                $("#sub_district_id").prop("readonly", false);
                $("#village_id").prop("readonly", false);
                $("#rt").removeAttr("readonly");
                $("#rw").removeAttr("readonly");
                $("#address").removeAttr("readonly");
            }
        })
        $('#status_id').select2({
            direction:top
        });

        $('#status_id').change(function(){
            let value = $(this).val()
            checkDuplicate()
            resetForm()
            if(inArray(value,[1,2,21])){
                showCaseSwabType(value,2)
            }else if (inArray(session,[2,3,7,9,20,10])){
                showCaseSwabType(value)
            }

            if(value == 21) showCaseTravelPlace()

            if(inArray(value,[1,11])) $("#case_saverity_level").show()
            else $("#case_saverity_level").hide()
        })

        $('#btn-criteria-rdt').click(function(){
            let status_id = $("#status_id").val()
            const url = "https://admin.corona.jatengprov.go.id/all-record/antigen/criteria"+"?value_id=criteria&value_text=criteria_text_rdt&status_id="+status_id
            openFancybox(url);
        });

        $('#check_duplicate').click(function(){
            checkDuplicate()
        })

        $('input[type=radio][name=result_rdt]').change(function() {
            setKeterangan()
        });

        $('#criteria_text_rdt').change(function (){
            setKeterangan()
            setPurpose()
        })

        function validNik(){
            let value = $('#nik').val()
            let before = null
            let result = true
            let count = 0
            for(i=0;i<4;i++){
                if(before == null) before = value.charAt(i)
                else if (before == value.charAt(i)) count++
            }
            if(count >3) result = false
            return result
        }

        $('#cek-nik').click(function (){
            const val = $('#nik').val()
            if(val.length == 16 && validNik()){
                // if(val % 10 != 0){
                    $('#kd_pasien').val('')
                    $('#cek-nik').attr("disabled", true);
                    $.ajax({
                        type: "GET",
                        url: "https://admin.corona.jatengprov.go.id/people/check-nik",
                        data: {
                            'nik':val
                        },
                        success:function (data){
                            isCheckValid = true
                            if(data.is_from_capil){
                                $('#name').val(data.capil_name)
                                if(data.capil_sex == 'L') $("#sexL").prop('checked',true)
                                else $("#sexP").prop('checked',true)
                                $('#name').attr("readonly", true)
                                $('#birth_date').val(data.capil_tgl_lahir)
                                $('#age_year').val(data.capil_age)
                                $('#age_month').val(data.capil_age_month)
                                $('#job').val(data.capil_job).trigger('change')
                                if(inArray(data.capil_gol_darah,['A','B','AB','O'])){
                                    $('#blood_type').val(data.capil_gol_darah).trigger('change')
                                }
                                if(data.capil_name != data.name || data.capil_sex != data.sex || data.capil_age != data.age){
                                    Swal.fire(
                                        'Data NAR dan CAPIL Tidak Sama',
                                        '- Data NAR - <br>' +
                                        'Nama : '+data.name + '<br>'+
                                        'Umur : '+data.age  + '<br>'+
                                        'Sex  : '+data.sex  + '<br>'+
                                        '- Data Capil -<br>'+
                                        'Nama : '+data.capil_name + '<br>'+
                                        'Umur : '+data.capil_age  + '<br>'+
                                        'Sex  : '+data.capil_se  + '<br>'+
                                        "<br> <strong>Tolong Perbaiki DATA Nya DI NAR</strong>",
                                        'warning'
                                    )
                                }
                                Swal.fire(
                                    'Berhasil mendapatkan data CAPIL dan NAR',
                                    'Data NAMA,UMUR,JENIS KELAMIN dari capil tidak boleh di ubah sedangkan data lainnya yang dari NAR hanya bersifat saran,silahkan di rubah mengikuti data kondisi lapangan',
                                    'info'
                                )
                            }else{
                                $('#name').val(data.name)
                                if(data.sex == 'L') $("#sexL").prop('checked',true)
                                else $("#sexP").prop('checked',true)
                                $('#name').removeAttr("readonly");
                                if(data.name){
                                    Swal.fire(
                                        'Berhasil mendapatkan data NAR',
                                        'Data NAR hanya bersifat saran,silahkan di rubah mengikuti data kondisi lapangan',
                                        'info'
                                    )
                                }
                            }
                            $('#kd_pasien').val(data.kd_pasien)
                            if(data.province_id){
                                $('#province_id').val(data.province_id).trigger('change')
                                district.then(()=>{
                                    $('#district_id').val(data.district_id).trigger('change')
                                    subDistrict.then(()=>{
                                        $('#sub_district_id').val(data.sub_district_id).trigger('change')
                                        village.then(()=>{
                                            $('#village_id').val(data.village_id).trigger('change')
                                        })
                                    })
                                })
                                $('#address').val(data.address)
                                $('#rt').val(data.rt)
                                $('#rw').val(data.rw)
                            }
                            if(data.capil_prov_id){
                                $('#ktp_province_id').val(data.capil_prov_id).trigger('change')
                                ktpDistrict.then(()=>{
                                    $('#ktp_district_id').val($('#ktp_district_id').find("option:contains('"+data.capil_kab+"')").val()).trigger('change')
                                    ktpSubDistrict.then(()=>{
                                        $('#ktp_sub_district_id').val($('#ktp_sub_district_id').find("option:contains('"+data.capil_kec+"')").val()).trigger('change')
                                        ktpVillage.then(()=>{
                                            $('#ktp_village_id').val(data.capil_kel_id).trigger('change')
                                            $('#ktp_village_id').val($('#ktp_village_id').find("option:contains('"+data.capil_kel+"')").val()).trigger('change')
                                        })
                                    })
                                })
                                $('#ktp_address').val(data.capil_alamat);
                                $('#ktp_rt').val(data.capil_rt)
                                $('#ktp_rw').val(data.capil_rw)
                            }
                            $('#kd_pasien').val(data.kd_pasien)
                            $('#phone_number').val(data.phone_number).trigger('input')

                        },
                        error:function(data) {
                            let resp = JSON.parse(data.responseText)
                            Swal.fire(
                                resp.error,
                                resp.message,
                                'error'
                            )
                            $('#cek-nik').removeAttr("disabled");
                        }
                    })
                    .done(()=>{
                        $('#cek-nik').removeAttr("disabled");
                    })
                // }else{
                //     Swal.fire(
                //         'Error!',
                //         'NIK Tidak Boleh Belakangnya 0',
                //         'error'
                //     )
                // }
            }else if(val.length > 16){
                Swal.fire(
                    'Error!',
                    'NIK Tidak Boleh Lebih dari 16 Digit',
                    'error'
                )
            }else{
                Swal.fire(
                    'Error!',
                    'Nik Tidak Boleh Kosong atau kurang dari 16 digit, <br>' +
                    'Apabila tidak ada identitas,maka klik WNI Tanpa Identitas !',
                    'error'
                )
            }
        })

        // on change pilih kabupaten
        $('#province_id').change(function() {
            const idProv = $(this).val()
            // change desa
            $('#sub_district_id').html('<option value="null" disabled selected>Pilih Kecamatan</option>')
            $('#village_id').html('<option value="null" disabled selected>Pilih Kecamatan</option>')
            // console.log('prov', idProv)
            district = new Promise((resolve) => {
                $.get("https://admin.corona.jatengprov.go.id/people/list/area" +'?type=kab&id='+idProv, function(data) {
                    $('#district_id').html(data)
                    resolve(true)
                })
            })
        });

        // on change pilih ktp provinsi
        $('#ktp_province_id').change(function() {
            const idProv = $(this).val()
            // change desa
            $('#ktp_sub_district_id').html('<option value="null" disabled selected>Pilih Kecamatan</option>')
            $('#ktp_village_id').html('<option value="null" disabled selected>Pilih Kecamatan</option>')
            // console.log('prov', idProv)
            ktpDistrict = new Promise((resolve) => {
                $.get("https://admin.corona.jatengprov.go.id/people/list/area" +'?type=kab&id='+idProv, function(data) {
                    $('#ktp_district_id').html(data)
                    resolve(true)
                })
            })
        });

        // on change pilih kabupaten
        $('#district_id').change(function() {
            const idProv = $(this).val()
            // change desa
            $('#village_id').html('<option value="null" disabled selected>Pilih Desa</option>')
            // console.log('prov', idProv)
            subDistrict = new Promise((resolve) => {
                $.get("https://admin.corona.jatengprov.go.id/people/list/area" +'?type=kec&id='+idProv, function(data) {
                    $('#sub_district_id').html(data)
                    resolve(true)
                })
            })
        });

        $('#ktp_district_id').change(function() {
            const idProv = $(this).val()
            // change desa
            $('#ktp_village_id').html('<option value="null" disabled selected>Pilih Desa</option>')
            // console.log('prov', idProv)
            ktpSubDistrict = new Promise((resolve) => {
                $.get("https://admin.corona.jatengprov.go.id/people/list/area" +'?type=kec&id='+idProv, function(data) {
                    $('#ktp_sub_district_id').html(data)
                    resolve(true)
                })
            })
        });

        // on change pilih kecamatan
        $('#sub_district_id').change(function() {
            const idKec = $(this).val()
            // console.log('kec', idKec)
            village = new Promise((resolve) => {
                $.get("https://admin.corona.jatengprov.go.id/people/list/area" +'?type=desa&id='+idKec, function(data) {
                    $('#village_id').html(data)
                    resolve(true)
                })
            })
        });

        $('#ktp_sub_district_id').change(function() {
            const idKec = $(this).val()
            // console.log('kec', idKec)
            ktpVillage = new Promise((resolve) => {
                $.get("https://admin.corona.jatengprov.go.id/people/list/area" +'?type=desa&id='+idKec, function(data) {
                    $('#ktp_village_id').html(data)
                    resolve(true)
                })
            })
        });

        // on submit
        $('#tambah').on('submit',function(event) {
            event.preventDefault();
            event.stopImmediatePropagation();
            let form = $(this)
            // console.log(form.serialize())
            if(validation()){
                let status = $('#status_id').val()
                let name = $('#name').val()
                if(inArray(status,[1,2])){
                    Swal.fire({
                        title: 'Anda Yakin MengKONFIRMkan '+name+' ?',
                        text: "Data ini akan di kirim sebagai rilis dan data rilis tidak bisa di rubah,Mohon cek kembali bila ada kesalahan",
                        icon: 'warning',
                        showCancelButton: true,
                        confirmButtonColor: '#3085d6',
                        cancelButtonColor: '#d33',
                        confirmButtonText: 'Iya',
                        cancelButtonText:'Tidak'
                    }).then((result) => {
                        if (result.value) {
                            postdata(form)
                        }
                    })
                }else{
                    postdata(form)
                }

            }
        })

        function validation(){
            let message = null

            let province_id = $('#province_id').val()
            let district_id = $('#district_id').val()
            let sub_district_id = $('#sub_district_id').val()
            let village_id = $('#village_id').val()
            let ktp_province_id = $('#ktp_province_id').val()
            let ktp_district_id = $('#ktp_district_id').val()
            let ktp_sub_district_id = $('#ktp_sub_district_id').val()
            let ktp_village_id = $('#ktp_village_id').val()
            let tgl_lapor = $('#tgl_lapor').val()
            let status = $('#status_id').val()
            if(!isCheckValid) message = "Klik Tombol Cari Di sebelah input NIK Terlebih dahulu"

            // Tanggal Masuk/Lapor
            if(isEmpty(tgl_lapor)) message = 'Tanggal Masuk/Lapor RS'
            // status
            if(isEmpty(status)) message = 'Status'
            // validasi desa
            if(province_id != '32676' && isEmpty(village_id)) message = 'Domisili Desa'
            // validasi kecamatan
            if(isEmpty(sub_district_id)) message = 'Domisili Kecamatan'
            // validasi kabupaten / kota
            if(isEmpty(district_id)) message = 'Domisili Kota / Kab'
            // validasi provinsi
            if(isEmpty(province_id)) message = 'Domisili Provinsi'
            // validasi desa
            if(ktp_province_id != '32676' && isEmpty(ktp_village_id)) message = 'KTP Desa'
            // validasi kecamatan
            if(isEmpty(ktp_sub_district_id)) message = 'KTP Kecamatan'
            // validasi kabupaten / kota
            if(isEmpty(ktp_district_id)) message = 'KTP Kota / Kab'
            // validasi provinsi
            if(isEmpty(ktp_province_id)) message = 'KTP Provinsi'

            if($('#case_swab_type').is(":visible") && inArray(status,[1,2])){
                if(isEmpty($('#swab_type').val())) message = "Jenis Test"
            }
            if($('#case_travel_place').is(":visible")){
                if(isEmpty($('#travel_place').val())) message = "Riwayat Perjalanan"
                if(isEmpty($('#travel_date_of_departure').val())) message = "TGL Berangkat"
            }
            if($('#case_saverity_level').is(":visible")){
                if(isEmpty($('#saverity_level').val())) message = "Saverity Level"
            }

            if($('#case_swab_rdt').is(":visible")){
                let resultRdt = $('input[name="result_rdt"]:checked').val();
                if(inArray(status,[1,2,7]) && resultRdt == 'NEGATIF') message = "mengCOVIDkan orang dengan hasil NEGATIF ?, mungkin anda sedang mengantuk,mohon istirahat sebentar dan coba cek kembali inputan anda !"
                if(isEmpty($('#criteria_text_rdt').val())) message = 'Kriteria'
                if(isEmpty($('#swab_period_rdt').val())) message = 'Pengambilan Spesimen RDT Ke'
                if(isEmpty($('#test_date_rdt').val())) message = 'Tanggal Test'
                if(isEmpty($('#speciment_code_rdt').val())) message = 'Kode Spesimen'
                if(isEmpty($('#purpose-rdt').val())) message = 'Tujuan'
                if(isEmpty($('#keterangan_rdt').val())) message = 'Keterangan'
            }
            if($('#case_genose').is(":visible")){
                if(isEmpty($('#swab_period_genose').val())) message = 'Pengambilan Spesimen RDT Ke'
                if(isEmpty($('#test_date_genose').val())) message = 'Tanggal Test'
                if(isEmpty($('#result_genose').val())) message = 'Hasil Lab'
                if(isEmpty($('#speciment_code_genose').val())) message = 'Kode Spesimen'
            }
            if($('#case_travel_place').is(':visible')){
                if(isEmpty($('#travel_date_of_departure').val())) message = 'Tanggal Berangkat'
                if(isEmpty($('#travel_place').val())) message = 'Riwayat Perjalanan'
            }

            if(!isEmpty(message)){
                Swal.fire(
                    'Error!',
                    'Input '+message+' Terlebih dahulu',
                    'error'
                )
                return false
            }
            else if(isDuplicate){
                Swal.fire(
                    'Error!',
                    'Tekan Tombol Cek Duplicate Terlebih Dahulu !',
                    'error'
                )
                return false
            }
            else return true
        }

        // insert data
        function postdata(form){
            $.ajax({
                type: form.attr('method'),
                url: form.attr('action'),
                data: form.serialize(),
                beforeSend: function() {
                    $('.btn-submit').attr('disabled',true)
                },
                success:function(data) {
                    if(data.type == 'confirmed') $('#datatable-confirmed').DataTable().ajax.reload(null,false);
                    if(data.type == 'probable') $('#datatable-probable').DataTable().ajax.reload(null,false);
                    if(data.type == 'suspect') $('#datatable-suspect').DataTable().ajax.reload(null,false);
                    if(data.type == 'close-contact') $('#datatable-close-contact').DataTable().ajax.reload(null,false);

                    // check odp exist
                    $.post('https://admin.corona.jatengprov.go.id/people/check-odp-exist', {
                        _method: 'POST', _token: "Egoh8yaLYW8bFpOFptmkrd1Skn4oeTGp4oHnmzEA",
                        data: data.pasien
                    })
                        .done(function(exist){
                            if(exist.error) {
                                // berarti ada
                                Swal.fire({
                                    type: 'warning',
                                    title: 'Apakah anda ingin mengintegerasikan?',
                                    text: "Data sudah pernah ada di ODP",
                                    showCancelButton: true,
                                    confirmButtonColor: '#3085d6',
                                    cancelButtonColor: '#d33',
                                    confirmButtonText: 'Ya, Simpan!'
                                }).then(function(res) {
                                    if(res.value) {
                                        // post simpan integrasi
                                        $.post('https://admin.corona.jatengprov.go.id/people/simpan-odp-exist', {
                                            _method: 'POST', _token: "Egoh8yaLYW8bFpOFptmkrd1Skn4oeTGp4oHnmzEA",
                                            id_odp: exist.data.id_odp, id_pdp: exist.data.id_pdp
                                        })
                                            .done(function(){
                                                Swal.fire(
                                                    'Success!',
                                                    exist.message,
                                                    'success'
                                                )
                                                $.fancybox.close();
                                            })
                                            .fail(function(err) {
                                            });
                                    }
                                });
                            }else{
                                Swal.fire(
                                    'Success!',
                                    exist.message,
                                    'success'
                                )
                                $.fancybox.close();
                            }
                        })
                        .fail(function(err) {
                        })
                },
                error:function(data) {
                    let resp = JSON.parse(data.responseText)
                    Swal.fire(
                        resp.message,
                        (resp.errors)?JSON.stringify(resp.errors):resp.message,
                        'error'
                    )
                },
                complete:function(){
                    $('.btn-submit').removeAttr('disabled')
                }
            })
        }

        function isEmpty(val){
            return (val === undefined || val == null || val.length <= 0 || val == '');
        }

        /* Pekerjaan */
        $('#job_place').select2({
            ajax: {
                url: "https://admin.corona.jatengprov.go.id/patient/select/get-job-places",
                dataType: 'json',
                delay: 500,
                data: function (params) {
                    return {
                        search: params.term
                    };
                },
                processResults: function (data) {
                    return {
                        results: $.map(data, function (item) {
                            return {
                                text: item.name,
                                id: JSON.stringify(item)
                            }
                        })
                    };
                },
                cache: true
            },
            tags: true,
            placeholder: 'Nama tempat anda berkarya',
            minimumInputLength: 3
        });

        /* End pekerjaan */

        function checkDuplicate(){
            let name = $('#name').val()
            let age = $('#age_year').val()
            let sex = $('input[name="sex"]:checked').val();
            let district_id = $('#district_id').val()
            let sub_district_id = $('#sub_district_id').val()
            let village_id = $('#village_id').val()

            if(isValidCheckDuplicate(name,age,sex,district_id,sub_district_id,village_id)){
                $.ajax({
                    type: "GET",
                    url: "https://admin.corona.jatengprov.go.id/people/check-duplicate",
                    data: {
                        name,
                        age,
                        sex,
                        district_id,
                        sub_district_id,
                        village_id
                    },
                    success:function(){
                      isDuplicate = false;
                      $('#check_duplicate').hide()
                    },
                    error:function(data) {
                        let resp = JSON.parse(data.responseText)
                        Swal.fire(
                            resp.error,
                            resp.message,
                            'error'
                        )
                    }
                })
            }
        }

        function isValidCheckDuplicate(name,age,sex,district_id,sub_district_id,village_id){
            if(!isEmpty(district_id) && district_id != '32676'){
                if(isEmpty(sub_district_id) || isEmpty(village_id)){
                    Swal.fire(
                        'Inputan Kurang',
                        'Pilih Desa / Kecamatan',
                        'error'
                    )
                    return false
                }
            }
            if(isEmpty(name)){
                Swal.fire(
                    'Inputan Kurang',
                    'Masukan nama',
                    'error'
                )
                return false
            }
            if(isEmpty(sex)){
                Swal.fire(
                    'Inputan Kurang',
                    'Pilih Jenis Kelamin',
                    'error'
                )
                return false
            }
            if(isEmpty(age)){
                Swal.fire(
                    'Inputan Kurang',
                    'Masukan Tanggal Lahir',
                    'error'
                )
                return false
            }
            return true;
        }

        function getAge(birthday){
            let dobMonth= birthday.getMonth()+1;
            let dobDay= birthday.getDate();
            let dobYear= birthday.getFullYear();

            let now = new Date
            let nowDay= now.getDate();
            let nowMonth = now.getMonth() + 1;  //jan = 0 so month + 1
            let nowYear= now.getFullYear();

            let ageYear = nowYear - dobYear;
            let ageMonth = nowMonth - dobMonth;
            let ageDay = nowDay- dobDay;
            if (ageMonth < 0) {
                ageYear--;
                ageMonth = (12 + ageMonth);
            }
            if (nowDay < dobDay) {
                ageMonth--;
                ageDay = 30 + ageDay;
                if(ageMonth<0){
                    ageYear--;
                    ageMonth+=12;
                }
            }
            ageYear = (ageYear>0)?ageYear:0;
            $('#age_year').val(ageYear)
            $('#age_month').val(ageMonth)
        }

        $('#symptom_rdt').select2({
            ajax: {
                url: "https://admin.corona.jatengprov.go.id/patient/select/symptom",
                dataType: 'json',
                delay: 250,
                data: function (params) {
                    return {
                        search: params.term
                    };
                },
                processResults: function (data) {
                    return {
                        results: $.map(data.data, function (item) {
                            return {
                                text: item.name,
                                id: item.id
                            }
                        })
                    };
                },
                cache: true
            },
            placeholder: 'Gejala / Abaikan jika tidak ada',
            minimumInputLength: 1
        });

        function showCaseSwabType(status,swab_type_id = 0){
            $('#case_swab_type').show()
            $.get("https://admin.corona.jatengprov.go.id/people/list/test-type" +'?status_id='+status, function(data) {
                $('#case_swab_type').html(data)
                $('#swab_type').change(checkLoadCaseSwab)
                if(swab_type_id != 0){
                    $("#swab_type").val(swab_type_id).trigger('change')
                    if(swab_type_id == 2) getSampleCode()
                }else{
                    $("#swab_type").val('').trigger('change')
                }
            })
        }
        function showCaseTravelPlace(){
            $('#case_travel_place').show()
            $.get("https://admin.corona.jatengprov.go.id/people/list/travel-place", function(data) {
                $('#case_travel_place').html(data)
            })
        }

        function showCaseGenose(){
            $('#case_genose').show()
            $.get("https://admin.corona.jatengprov.go.id/people/list/genose", function(data) {
                $('#case_genose').html(data)
            })
        }

        function checkLoadCaseSwab(){
            const value = $("#swab_type").val()
            $('#case_swab_rdt').hide()
            $('#case_genose').hide()
            if(value == "2") {
                $('#case_swab_rdt').show()
                getSampleCode()
            }
            else if(value == "3") {
                showCaseGenose()
            }
        }

        function resetForm(){
            $('#case_swab_type').hide()
            $("#case_saverity_level").hide()
            $("#case_travel_place").hide()
            $('#case_swab_rdt').hide()
            $('#case_genose').hide()
        }

        $('#btn-saverity-level').click(function(){
            const url = "https://admin.corona.jatengprov.go.id/people/list/saverity-level"+"?value_id=saverity_level&value_text=saverity_level_text"
            openFancybox(url);
        });

        function getSampleCode(){
            $.get("https://admin.corona.jatengprov.go.id/all-record/antigen/generate-sample-code", function(data) {
                $('#speciment_code_rdt').val(data);
            });
        }

        function openFancybox(url) {
            $.fancybox.open({src: url, type: 'ajax'});
        }
    })
</script>
